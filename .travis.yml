env:
  - CPM_SOURCE_CACHE=$HOME/cpm_source_cache

language: cpp

branches:
  only:
  - travis

os:
  - windows
  - osx
  - linux

install:
- |-
  case $TRAVIS_OS_NAME in
    windows)
      choco install visualstudio2019buildtools
      choco upgrade cmake
      ;;
    osx)
      brew upgrade cmake
      ;;
    linux)
      DEPS_DIR="${TRAVIS_BUILD_DIR}/deps"
      mkdir ${DEPS_DIR} && cd ${DEPS_DIR}
      travis_retry wget --no-check-certificate https://cmake.org/files/v3.20/cmake-3.20.0-linux-x86_64.tar.gz
      tar -xvf cmake-3.20.0-linux-x86_64.tar.gz > /dev/null
      mv cmake-3.3.2-Linux-x86_64 cmake-install
      PATH=${DEPS_DIR}/cmake-install:${DEPS_DIR}/cmake-install/bin:$PATH
      cd ${TRAVIS_BUILD_DIR}
      ;;
  esac

script:
  - cmake . 
  - cmake --build .

cache:
  directories:
    - $HOME/AppData/Local/Temp/chocolatey
    - $CPM_SOURCE_CACHE